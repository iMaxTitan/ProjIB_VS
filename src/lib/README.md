изуси# Utilities 

# Архитектурные принципы работы с данными (ReportIB)

## Использование представлений (views) вместо прямых таблиц

- **v_user_details** — представление для получения информации о пользователях с отделами
- **v_annual_plans** — представление для годовых планов
- **v_quarterly_plans** — представление для квартальных планов
- **v_weekly_plans** — представление для недельных планов

**Преимущества:**
- Единая точка доступа к связанным данным
- Упрощение запросов на клиентской стороне
- Лучшая производительность за счёт предварительного соединения
- Более чистый код без объединения данных на клиенте

**Best practice:**
- При разработке новых функций использовать только представления, если нужны данные из нескольких связанных таблиц.

---

## v_quarterly_plans — структура и назначение

- quarterly_id (uuid)
- annual_plan_id (uuid)
- department_id (uuid)
- department_name (text)
- quarter (integer)
- goal (text)
- expected_result (text)
- status (USER-DEFINED)
- process_id (uuid)
- process_name (text)
- weekly_plans_count (bigint)

**Назначение:**
- Агрегирует квартальные планы с привязкой к годовому плану, отделу и процессу
- weekly_plans_count — количество недельных планов, связанных с квартальным
- process_name — наименование процесса, связанного с квартальным планом

**Источник правды для квартальных планов — только это представление!**

{{ ... }}
