---
name: document-changes
description: "Используй этот скилл для документирования согласованных с пользователем изменений в проекте. Фиксирует изменения в архитектуре, UI, базе данных и бизнес-логике в соответствующих файлах документации."
---

# Документирование изменений проекта

## Обзор

Этот скилл помогает фиксировать согласованные изменения в документации проекта ReportIB. После того как изменения реализованы и приняты пользователем, используй этот скилл для обновления соответствующей документации.

## Когда использовать

Вызывай этот скилл после того как:
- Реализованы и согласованы изменения в UI/UX
- Добавлена новая функциональность
- Изменена архитектура или структура кода
- Добавлены новые API/RPC функции
- Изменена схема базы данных
- Обновлены правила или паттерны разработки

## Структура документации проекта

```
docs/
├── DEVELOPER_GUIDE.md          # Главный гайд для разработчиков
├── BUSINESS_REQUIREMENTS.md    # Бизнес-требования
├── UI_DESIGN_SYSTEM.md         # Система дизайна
├── UI_CHEATSHEET.md            # Шпаргалка по UI
├── architecture/
│   ├── README.md               # Общая архитектура
│   ├── PLAN_TYPES.md           # Типы планов
│   ├── MONTHLY_PLANS.md        # Месячные планы
│   └── REPORTS.md              # Отчеты
├── database/
│   └── SCHEMA.md               # Схема БД
└── modules/
    ├── auth/                   # Документация авторизации
    ├── activity/               # Документация активности
    └── ...
```

## Процесс документирования

### 1. Определение типа изменений

Спросить/уточнить у пользователя:
- Какие именно изменения были согласованы?
- К какой области относятся? (UI, архитектура, БД, бизнес-логика)
- Нужно ли обновить несколько документов?

### 2. Выбор документов для обновления

| Тип изменений | Документ(ы) |
|---------------|-------------|
| UI компоненты, стили, цвета | `docs/UI_DESIGN_SYSTEM.md`, `CLAUDE.md` |
| Навигация, структура дашборда | `docs/DEVELOPER_GUIDE.md` (секция Навигация) |
| Новые функции планов/задач | `docs/architecture/PLAN_TYPES.md`, `docs/DEVELOPER_GUIDE.md` |
| Таблицы, views, RPC функции | `docs/database/SCHEMA.md` |
| Новые модули/сервисы | `docs/architecture/README.md` |
| Роли и права доступа | `docs/DEVELOPER_GUIDE.md` (секция Роли) |
| Бизнес-правила | `docs/BUSINESS_REQUIREMENTS.md` |

### 3. Формат записи изменений

#### Для UI изменений в DEVELOPER_GUIDE.md:

```markdown
### Семантическая палитра (Кодирование цветом)

1.  **Годовой план (Annual)**:
    *   Цвет: **Amber** (Янтарный)
    *   Градиент карточки: `from-amber-500 to-orange-500`
    ...
```

#### Для функциональных изменений:

```markdown
### Функциональность удаления планов

**Правила удаления:**
- Удалить может только создатель плана
- Иерархия: Годовой → Квартальный → Месячный → Задачи
- При удалении месячного плана каскадно удаляются связанные задачи

**Файлы:**
- `src/lib/plans/plan-service.ts` — функции `canDeleteAnnualPlan`, `deleteAnnualPlan`, etc.
- `src/components/plans/details/*` — UI кнопки удаления
```

#### Для БД изменений в SCHEMA.md:

```markdown
### delete_annual_plan (новая функция)

Удаление годового плана с проверкой прав.

| Параметр | Тип | Описание |
|----------|-----|----------|
| p_annual_id | uuid | ID плана |
| p_user_id | uuid | ID пользователя |

**Проверки:**
- Только создатель может удалить
- Нет связанных квартальных планов
```

### 4. Обновление CLAUDE.md

Если изменения влияют на правила разработки, обновить секцию в `CLAUDE.md`:

```markdown
## Правила удаления планов

При реализации удаления планов:
1. Проверять права: только создатель
2. Проверять иерархию: сначала дочерние
3. Каскадное удаление для месячных планов
```

## Контрольный список

- [ ] Определён тип изменений
- [ ] Выбраны документы для обновления
- [ ] Добавлено описание изменений
- [ ] Указаны затронутые файлы
- [ ] Обновлена дата/версия (если применимо)
- [ ] Проверена согласованность с существующей документацией

## Примеры использования

### Пример 1: Документирование изменения цветов

```
Пользователь: /document-changes

Ответ: Какие изменения нужно задокументировать?

Пользователь: Мы изменили цвета вкладок планов - квартальные теперь purple, месячные indigo

→ Обновить docs/DEVELOPER_GUIDE.md секцию "Вкладки планов"
→ Обновить CLAUDE.md если есть упоминания цветов
```

### Пример 2: Документирование новой функции

```
Пользователь: /document-changes удаление планов

→ Создать секцию в docs/DEVELOPER_GUIDE.md
→ Добавить RPC функции в docs/database/SCHEMA.md
→ Обновить docs/architecture/PLAN_TYPES.md
```

## После документирования

1. Показать пользователю список обновлённых файлов
2. Предложить сделать коммит изменений документации:
   ```
   docs: Обновлена документация - <краткое описание>
   ```
